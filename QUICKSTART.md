# Al Aroma - –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

## –ó–∞ 5 –º–∏–Ω—É—Ç –¥–æ –∑–∞–ø—É—Å–∫–∞

### 1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è

```bash
docker --version   # –î–æ–ª–∂–µ–Ω –±—ã—Ç—å >= 24.0
docker-compose --version  # –î–æ–ª–∂–µ–Ω –±—ã—Ç—å >= 2.20
```

### 2. –ù–∞—Å—Ç—Ä–æ–π—Ç–µ –æ–∫—Ä—É–∂–µ–Ω–∏–µ

```bash
# –°–∫–æ–ø–∏—Ä—É–π—Ç–µ –ø—Ä–∏–º–µ—Ä –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è
cp .env.example .env

# –û—Ç–∫—Ä–æ–π—Ç–µ .env –∏ –∏–∑–º–µ–Ω–∏—Ç–µ —Å–ª–µ–¥—É—é—â–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã:
# POSTGRES_PASSWORD=–≤–∞—à_—Å–∏–ª—å–Ω—ã–π_–ø–∞—Ä–æ–ª—å
# REDIS_PASSWORD=–≤–∞—à_—Å–∏–ª—å–Ω—ã–π_–ø–∞—Ä–æ–ª—å
# JWT_SECRET=—Å–ª—É—á–∞–π–Ω–∞—è_—Å—Ç—Ä–æ–∫–∞_–º–∏–Ω–∏–º—É–º_32_—Å–∏–º–≤–æ–ª–∞
```

**–ì–µ–Ω–µ—Ä–∞—Ü–∏—è —Å–ª—É—á–∞–π–Ω—ã—Ö –ø–∞—Ä–æ–ª–µ–π**:
```bash
# –î–ª—è Linux/macOS
openssl rand -base64 32

# –ò–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –æ–Ω–ª–∞–π–Ω –≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä
```

### 3. –ó–∞–ø—É—Å—Ç–∏—Ç–µ —Å–∏—Å—Ç–µ–º—É

```bash
# –ï—Å–ª–∏ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω make
make install  # –ü–µ—Ä–≤–æ–Ω–∞—á–∞–ª—å–Ω–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞
make dev      # –ó–∞–ø—É—Å–∫

# –ò–ª–∏ –±–µ–∑ make
docker-compose up -d
```

### 4. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å

–û—Ç–∫—Ä–æ–π—Ç–µ –≤ –±—Ä–∞—É–∑–µ—Ä–µ:
- **Frontend**: http://localhost:3001
- **Backend API**: http://localhost:3000
- **API Docs**: http://localhost:3000/api/docs
- **Nginx**: http://localhost:80

### 5. –ü–µ—Ä–≤—ã–π –≤—Ö–æ–¥

**–£—á–µ—Ç–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é**:
- Email: `admin@alaroma.local`
- Password: `admin123`

‚ö†Ô∏è **–í–ê–ñ–ù–û**: –ò–∑–º–µ–Ω–∏—Ç–µ –ø–∞—Ä–æ–ª—å –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞ —Å—Ä–∞–∑—É –ø–æ—Å–ª–µ –ø–µ—Ä–≤–æ–≥–æ –≤—Ö–æ–¥–∞!

## –ü–æ–ª–µ–∑–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã

### –° –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º Makefile

```bash
make help          # –°–ø–∏—Å–æ–∫ –≤—Å–µ—Ö –∫–æ–º–∞–Ω–¥
make dev           # –ó–∞–ø—É—Å–∫ –≤ dev —Ä–µ–∂–∏–º–µ
make logs          # –ü–æ–∫–∞–∑–∞—Ç—å –ª–æ–≥–∏
make logs-backend  # –õ–æ–≥–∏ backend
make logs-frontend # –õ–æ–≥–∏ frontend
make ps            # –°—Ç–∞—Ç—É—Å –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤
make health        # –ü—Ä–æ–≤–µ—Ä–∫–∞ –∑–¥–æ—Ä–æ–≤—å—è —Å–µ—Ä–≤–∏—Å–æ–≤
make down          # –û—Å—Ç–∞–Ω–æ–≤–∫–∞
make restart       # –ü–µ—Ä–µ–∑–∞–ø—É—Å–∫
make clean         # –ü–æ–ª–Ω–∞—è –æ—á–∏—Å—Ç–∫–∞ (—É–¥–∞–ª—è–µ—Ç –¥–∞–Ω–Ω—ã–µ!)
make backup        # –°–æ–∑–¥–∞—Ç—å —Ä–µ–∑–µ—Ä–≤–Ω—É—é –∫–æ–ø–∏—é
make shell-db      # –ü–æ–¥–∫–ª—é—á–∏—Ç—å—Å—è –∫ PostgreSQL
make pgadmin       # –ó–∞–ø—É—Å—Ç–∏—Ç—å PgAdmin
```

### –ë–µ–∑ Makefile

```bash
# –ó–∞–ø—É—Å–∫
docker-compose up -d

# –õ–æ–≥–∏
docker-compose logs -f

# –°—Ç–∞—Ç—É—Å
docker-compose ps

# –û—Å—Ç–∞–Ω–æ–≤–∫–∞
docker-compose down

# –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ –ë–î
docker-compose exec postgres psql -U alaroma_user alaroma

# –†–µ–∑–µ—Ä–≤–Ω–æ–µ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ
docker-compose exec postgres pg_dump -U alaroma_user alaroma > backup.sql
```

## –°—Ç—Ä—É–∫—Ç—É—Ä–∞ API

### –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è

```bash
# –í—Ö–æ–¥
POST /api/auth/login
{
  "email": "admin@alaroma.local",
  "password": "admin123"
}

# –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è
POST /api/auth/register
{
  "email": "user@example.com",
  "password": "password",
  "fullName": "–ò–≤–∞–Ω –ò–≤–∞–Ω–æ–≤",
  "role": "salesperson"
}

# –í—ã—Ö–æ–¥
POST /api/auth/logout
```

### –¢–æ–≤–∞—Ä—ã

```bash
# –°–ø–∏—Å–æ–∫ —Ç–æ–≤–∞—Ä–æ–≤
GET /api/products?page=1&limit=20

# –°–æ–∑–¥–∞–Ω–∏–µ —Ç–æ–≤–∞—Ä–∞
POST /api/products
{
  "sku": "PROD-001",
  "name": "–î—É—Ö–∏ Chanel",
  "basePrice": 5000,
  "categoryId": "uuid"
}

# –ü–æ–ª—É—á–µ–Ω–∏–µ —Ç–æ–≤–∞—Ä–∞
GET /api/products/:id

# –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Ç–æ–≤–∞—Ä–∞
PATCH /api/products/:id

# –£–¥–∞–ª–µ–Ω–∏–µ —Ç–æ–≤–∞—Ä–∞
DELETE /api/products/:id
```

### –ü—Ä–æ–¥–∞–∂–∏

```bash
# –°–æ–∑–¥–∞–Ω–∏–µ –ø—Ä–æ–¥–∞–∂–∏
POST /api/sales
{
  "locationId": "uuid",
  "items": [
    {
      "productId": "uuid",
      "quantity": 2,
      "unitPrice": 5000
    }
  ],
  "paymentMethod": "cash",
  "promotionId": "uuid" // –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ
}

# –°–ø–∏—Å–æ–∫ –ø—Ä–æ–¥–∞–∂
GET /api/sales?page=1&limit=20&startDate=2024-01-01

# –û—Ç–º–µ–Ω–∞ –ø—Ä–æ–¥–∞–∂–∏
POST /api/sales/:id/cancel
```

### –°–∫–ª–∞–¥

```bash
# –û—Å—Ç–∞—Ç–∫–∏ –ø–æ –ª–æ–∫–∞—Ü–∏–∏
GET /api/inventory?locationId=uuid

# –ü–µ—Ä–µ–º–µ—â–µ–Ω–∏–µ —Ç–æ–≤–∞—Ä–∞
POST /api/inventory/transfer
{
  "productId": "uuid",
  "fromLocationId": "uuid",
  "toLocationId": "uuid",
  "quantity": 10
}

# –°–ø–∏—Å–∞–Ω–∏–µ —Ç–æ–≤–∞—Ä–∞
POST /api/inventory/writeoff
{
  "productId": "uuid",
  "locationId": "uuid",
  "quantity": 2,
  "reason": "–±—Ä–∞–∫"
}
```

### –ê–∫—Ü–∏–∏

```bash
# –ü—Ä–∏–º–µ–Ω–∏—Ç—å –∞–∫—Ü–∏—é –∫ –ø—Ä–æ–¥–∞–∂–µ
POST /api/promotions/apply
{
  "promotionId": "uuid",
  "saleId": "uuid"
}

# –°–ø–∏—Å–æ–∫ –∞–∫—Ç–∏–≤–Ω—ã—Ö –∞–∫—Ü–∏–π
GET /api/promotions/active
```

### –ü–æ–¥–∞—Ä–æ—á–Ω—ã–µ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç—ã

```bash
# –°–æ–∑–¥–∞—Ç—å —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç
POST /api/certificates
{
  "amount": 5000
}

# –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç
POST /api/certificates/:code/redeem
{
  "saleId": "uuid"
}

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç
GET /api/certificates/:code
```

## –†–æ–ª–∏ –∏ –¥–æ—Å—Ç—É–ø

### –ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä (admin)
- –ü–æ–ª–Ω—ã–π –¥–æ—Å—Ç—É–ø –∫–æ –≤—Å–µ–º —Ñ—É–Ω–∫—Ü–∏—è–º
- –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏
- –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –∞–∫—Ü–∏–π
- –û—Ç—á–µ—Ç–Ω–æ—Å—Ç—å

### –ú–µ–Ω–µ–¥–∂–µ—Ä (manager)
- –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å–∫–ª–∞–¥–æ–º
- –°–ø–∏—Å–∞–Ω–∏—è –∏ –∏–Ω–≤–µ–Ω—Ç–∞—Ä–∏–∑–∞—Ü–∏—è
- –ü—Ä–æ—Å–º–æ—Ç—Ä –æ—Ç—á–µ—Ç–æ–≤

### –ö–∞—Å—Å–∏—Ä (cashier)
- –¢–æ–ª—å–∫–æ –æ—Ñ–æ—Ä–º–ª–µ–Ω–∏–µ –ø—Ä–æ–¥–∞–∂
- –†–∞–±–æ—Ç–∞ —Å –∫–∞—Å—Å–æ–π

### –ü—Ä–æ–¥–∞–≤–µ—Ü (salesperson)
- –û—Ñ–æ—Ä–º–ª–µ–Ω–∏–µ –ø—Ä–æ–¥–∞–∂
- –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ —Å–∫–∏–¥–æ–∫
- –†–∞–±–æ—Ç–∞ —Å —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–∞–º–∏

### –ö–ª–∞–¥–æ–≤—â–∏–∫ (warehouse_worker)
- –°–∫–ª–∞–¥—Å–∫–∏–µ –æ–ø–µ—Ä–∞—Ü–∏–∏
- –ü—Ä–∏–µ–º–∫–∞ —Ç–æ–≤–∞—Ä–∞
- –ü–µ—Ä–µ–º–µ—â–µ–Ω–∏—è

## Troubleshooting

### –ü–æ—Ä—Ç—ã —É–∂–µ –∑–∞–Ω—è—Ç—ã

```bash
# –ò–∑–º–µ–Ω–∏—Ç–µ –ø–æ—Ä—Ç—ã –≤ .env
BACKEND_PORT=3100
FRONTEND_PORT=3101
POSTGRES_PORT=5433
```

### –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö –Ω–µ –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è

```bash
# –£–¥–∞–ª–∏—Ç–µ volume –∏ –ø–µ—Ä–µ—Å–æ–∑–¥–∞–π—Ç–µ
docker-compose down -v
docker-compose up -d postgres
```

### –û—à–∏–±–∫–∏ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è

```bash
# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏
docker-compose logs postgres
docker-compose logs backend

# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å–µ—Ç—å
docker network ls
docker network inspect alaroma_alaroma-network
```

### –ù–µ—Ç –¥–æ—Å—Ç—É–ø–∞ –∫ PgAdmin

```bash
# –ó–∞–ø—É—Å—Ç–∏—Ç–µ —Å –ø—Ä–æ—Ñ–∏–ª–µ–º tools
docker-compose --profile tools up -d
```

### –ú–µ–¥–ª–µ–Ω–Ω–∞—è —Ä–∞–±–æ—Ç–∞

```bash
# –£–≤–µ–ª–∏—á—å—Ç–µ —Ä–µ—Å—É—Ä—Å—ã Docker
# Docker Desktop ‚Üí Settings ‚Üí Resources
# –†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è: 4GB RAM, 2 CPU

# –û—á–∏—Å—Ç–∏—Ç–µ –Ω–µ–∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ –¥–∞–Ω–Ω—ã–µ
docker system prune -a
```

## –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏

1. **–ò–∑–º–µ–Ω–∏—Ç–µ –ø–∞—Ä–æ–ª—å –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞**
2. **–°–æ–∑–¥–∞–π—Ç–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π** –¥–ª—è –∫–∞–∂–¥–æ–π —Ä–æ–ª–∏
3. **–ù–∞—Å—Ç—Ä–æ–π—Ç–µ —Ç–æ—Ä–≥–æ–≤—ã–µ —Ç–æ—á–∫–∏** –∏ —Å–∫–ª–∞–¥—ã
4. **–î–æ–±–∞–≤—å—Ç–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏** –∏ —Ç–æ–≤–∞—Ä—ã
5. **–ù–∞—Å—Ç—Ä–æ–π—Ç–µ –∞–∫—Ü–∏–∏** –∏ —Å–∫–∏–¥–∫–∏
6. **–ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä—É–π—Ç–µ** —Å–æ–∑–¥–∞–Ω–∏–µ –ø—Ä–æ–¥–∞–∂–∏
7. **–ù–∞—Å—Ç—Ä–æ–π—Ç–µ —Ä–µ–∑–µ—Ä–≤–Ω–æ–µ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ**

## –ü–æ–ª–µ–∑–Ω—ã–µ —Å—Å—ã–ª–∫–∏

- [–ü–æ–ª–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è](README.md)
- [–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ —Å–∏—Å—Ç–µ–º—ã](ARCHITECTURE.md)
- [API –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è](http://localhost:3000/api/docs)
- [–ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö —Å—Ö–µ–º–∞](docker/postgres/init/01-init.sql)

## –ü–æ–ª—É—á–µ–Ω–∏–µ –ø–æ–º–æ—â–∏

–ï—Å–ª–∏ –≤–æ–∑–Ω–∏–∫–ª–∏ –ø—Ä–æ–±–ª–µ–º—ã:

1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏: `make logs` –∏–ª–∏ `docker-compose logs -f`
2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å—Ç–∞—Ç—É—Å: `make ps` –∏–ª–∏ `docker-compose ps`
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ health: `make health`
4. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ README.md –∏ ARCHITECTURE.md
5. –°–æ–∑–¥–∞–π—Ç–µ issue –≤ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–∏

## Production deployment

–î–ª—è production —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—è —Å–º. —Ä–∞–∑–¥–µ–ª "Production deployment" –≤ [README.md](README.md).

–ö—Ä–∞—Ç–∫–∞—è –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è:

```bash
# 1. –ù–∞—Å—Ç—Ä–æ–π—Ç–µ production .env
cp .env.example .env.production

# 2. –ò–∑–º–µ–Ω–∏—Ç–µ –í–°–ï –ø–∞—Ä–æ–ª–∏ –∏ —Å–µ–∫—Ä–µ—Ç—ã!

# 3. –ó–∞–ø—É—Å—Ç–∏—Ç–µ
docker-compose -f docker-compose.prod.yml --env-file .env.production up -d

# 4. –ù–∞—Å—Ç—Ä–æ–π—Ç–µ SSL (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ –Ω–æ —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)
```

---

**–£—Å–ø–µ—à–Ω–æ–≥–æ –∑–∞–ø—É—Å–∫–∞! üöÄ**
